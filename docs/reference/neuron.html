<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>neuron: class to represent traced neurons — neuron • nat</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="neuron: class to represent traced neurons — neuron" />
<meta property="og:description" content="neuron makes a neuron object from appropriate variables.
is.neuron will check if an object looks like a neuron.
as.neuron will convert a suitable object to a neuron
as.neuron.data.frame expects a block of SWC format data
as.neuron.ngraph converts a graph (typically an 
  ngraph object) to a neuron
as.neuron.igraph will convert an ngraph compatible
  igraph object into a neuron.
as.neuron.default will add class &quot;neuron&quot; to a neuron-like
  object." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Installation.html">Installation Details</a>
    </li>
    <li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/natverse/nat/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>neuron: class to represent traced neurons</h1>
    <small class="dont-index">Source: <a href='https://github.com/natverse/nat/blob/master/R/neuron.R'><code>R/neuron.R</code></a></small>
    <div class="hidden name"><code>neuron.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>neuron</code> makes a neuron object from appropriate variables.</p>
<p><code>is.neuron</code> will check if an object looks like a neuron.</p>
<p><code>as.neuron</code> will convert a suitable object to a neuron</p>
<p><code>as.neuron.data.frame</code> expects a block of SWC format data</p>
<p><code>as.neuron.ngraph</code> converts a graph (typically an 
  <code>ngraph</code> object) to a neuron</p>
<p><code>as.neuron.igraph</code> will convert an <code>ngraph</code> compatible
  <code><a href='https://rdrr.io/pkg/igraph/man/aaa-igraph-package.html'>igraph</a></code> object into a <code>neuron</code>.</p>
<p><code>as.neuron.default</code> will add class "neuron" to a neuron-like
  object.</p>
    </div>

    <pre class="usage"><span class='fu'>neuron</span><span class='op'>(</span>
  <span class='va'>d</span>,
  NumPoints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span>,
  <span class='va'>StartPoint</span>,
  BranchPoints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>integer</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>EndPoints</span>,
  <span class='va'>SegList</span>,
  SubTrees <span class='op'>=</span> <span class='cn'>NULL</span>,
  InputFileName <span class='op'>=</span> <span class='cn'>NULL</span>,
  NeuronName <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  MD5 <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>is.neuron</span><span class='op'>(</span><span class='va'>x</span>, Strict <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for ngraph</span>
<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>x</span>, vertexData <span class='op'>=</span> <span class='cn'>NULL</span>, origin <span class='op'>=</span> <span class='cn'>NULL</span>, Verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for igraph</span>
<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>matrix of vertices and associated data in SWC format</p></td>
    </tr>
    <tr>
      <th>NumPoints</th>
      <td><p>Number of points in master subtree</p></td>
    </tr>
    <tr>
      <th>StartPoint, BranchPoints, EndPoints</th>
      <td><p>Nodes of the neuron</p></td>
    </tr>
    <tr>
      <th>SegList</th>
      <td><p>List where each element contains the vertex indices for a 
single segments of the neuron, starting at root.</p></td>
    </tr>
    <tr>
      <th>SubTrees</th>
      <td><p>List of SegLists where a neuron has multiple unconnected 
trees (e.g. because the soma is not part of the graph, or because the 
neuronal arbour has been cut.)</p></td>
    </tr>
    <tr>
      <th>InputFileName</th>
      <td><p>Character vector with path to input file</p></td>
    </tr>
    <tr>
      <th>NeuronName</th>
      <td><p>Character vector containing name of neuron or a function 
with one argument (the full path) which returns the name. The default
(<code>NULL</code>) sets NeuronName to the file name without the file extension.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional fields to be included in neuron. Note that if these 
include CreatedAt, NodeName, InputFileStat or InputFileMD5, they will 
override fields of that name that are calculated automatically.</p></td>
    </tr>
    <tr>
      <th>MD5</th>
      <td><p>Logical indicating whether to calculate MD5 hash of input</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A neuron or other object to test/convert</p></td>
    </tr>
    <tr>
      <th>Strict</th>
      <td><p>Whether to check class of neuron or use a more relaxed
definition based on object being a list with a SegList component.</p></td>
    </tr>
    <tr>
      <th>vertexData</th>
      <td><p>A dataframe with SWC fields especially X,Y,Z,W,PointNo,
Parent.</p></td>
    </tr>
    <tr>
      <th>origin</th>
      <td><p>Root vertex, matched against labels (aka PointNo) when 
available (see details)</p></td>
    </tr>
    <tr>
      <th>Verbose</th>
      <td><p>Whether to be verbose (default: FALSE)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with elements: 
  (NumPoints,StartPoint,BranchPoints,EndPoints,nTrees,NumSegs,SegList, 
  [SubTrees]) NB SubTrees will only be present when nTrees&gt;1.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>neuron objects consist of a list containing multiple fields describing the 3D
location and connectivity of points in a traced neuron. The critical fields 
of a neuron, n, are n$d which contains a dataframe in SWC format and 
n$SegList which contains a representation of the neuron's topology used for 
most internal calculations. For historical reasons, n$SegList is limited to a
<em>single fully-connected</em> tree. If the tree contains multiple unconnected
subtrees, then these are stored in n$SubTrees and nTrees will be &gt;1; the 
"master" subtree (typically the one with the most points) will then be stored
in n$SegList and n$NumPoints will refer to the number of points in that 
subtree, not the whole neuron.</p>
<p>StartPoint, BranchPoints, EndPoints are indices matching the rows of 
  the vertices in <code>d</code> <strong>not</strong> arbitrary point numbers typically 
  encoded in <code>d$PointNo</code>.</p>
<p>Columns will be ordered c('PointNo','Label','X','Y','Z','W','Parent')</p>
<p>Uses a depth first search on the tree to reorder using the given 
  origin.</p>
<p>When the graph contains multiple subgraphs, only one will be chosen 
  as the master tree and used to construct the SegList of the resultant 
  neuron. However all subgraphs will be listed in the SubTrees element of the
  neuron and nTrees will be set appropriately.</p>
<p>When the graph vertices have a label attribute derived from PointNo,
  the origin is assumed to be specified with respect to the vertex labels 
  rather than the raw vertex ids.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='neuronlist.html'>neuronlist</a></code></p>
<p><code>graph.dfs, <a href='seglist.html'>as.seglist</a></code></p>
<p>Other neuron: 
<code><a href='ngraph.html'>ngraph</a>()</code>,
<code><a href='plot.neuron.html'>plot.neuron</a>()</code>,
<code><a href='potential_synapses.html'>potential_synapses</a>()</code>,
<code><a href='prune.html'>prune</a>()</code>,
<code><a href='resample.html'>resample</a>()</code>,
<code><a href='rootpoints.html'>rootpoints</a>()</code>,
<code><a href='spine.html'>spine</a>()</code>,
<code><a href='subset.neuron.html'>subset.neuron</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## See help for functions listed in See Also for more detailed examples</span>
<span class='co'>## Basic properties</span>
<span class='co'># a sample neuron </span>
<span class='va'>n</span> <span class='op'>=</span> <span class='va'>Cell07PNs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
<span class='co'># inspect its internal structure</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 24
#&gt;  $ CellType     : chr "DA1"
#&gt;  $ NeuronName   : chr "EBH11R"
#&gt;  $ InputFileName: 'AsIs' chr "/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc"
#&gt;  $ CreatedAt    : POSIXt[1:1], format: "2006-01-17 15:21:14"
#&gt;  $ NodeName     : Named chr "jefferis.joh.cam.ac.uk"
#&gt;   ..- attr(*, "names")= chr "nodename"
#&gt;  $ InputFileStat:'data.frame':	1 obs. of  10 variables:
#&gt;   ..$ size  : num 15379
#&gt;   ..$ isdir : logi FALSE
#&gt;   ..$ mode  : 'octmode' int 644
#&gt;   ..$ mtime : POSIXt[1:1], format: "2006-01-12 00:52:01"
#&gt;   ..$ ctime : POSIXt[1:1], format: "2006-01-12 00:52:01"
#&gt;   ..$ atime : POSIXt[1:1], format: "2006-01-17 15:21:14"
#&gt;   ..$ uid   : int 501
#&gt;   ..$ gid   : int 501
#&gt;   ..$ uname : chr "jefferis"
#&gt;   ..$ grname: chr "jefferis"
#&gt;  $ InputFileMD5 : Named chr "fcacee3f874cbe2c6ad96214e6fee337"
#&gt;   ..- attr(*, "names")= 'AsIs' chr "/GD/projects/PN2/TransformedTraces/DA1/EBH11R.tasc"
#&gt;  $ NumPoints    : int 180
#&gt;  $ StartPoint   : num 1
#&gt;  $ BranchPoints : num [1:16] 34 48 51 75 78 95 98 99 108 109 ...
#&gt;  $ EndPoints    : num [1:18] 1 42 59 62 80 85 96 100 102 112 ...
#&gt;  $ NumSegs      : int 33
#&gt;  $ SegList      :List of 33
#&gt;   ..$ : int [1:34] 1 2 3 4 5 6 7 8 9 10 ...
#&gt;   ..$ : int [1:9] 34 35 36 37 38 39 40 41 42
#&gt;   ..$ : num [1:7] 34 43 44 45 46 47 48
#&gt;   ..$ : int [1:4] 48 49 50 51
#&gt;   ..$ : int [1:9] 51 52 53 54 55 56 57 58 59
#&gt;   ..$ : num [1:4] 51 60 61 62
#&gt;   ..$ : num [1:14] 48 63 64 65 66 67 68 69 70 71 ...
#&gt;   ..$ : int [1:4] 75 76 77 78
#&gt;   ..$ : int [1:3] 78 79 80
#&gt;   ..$ : num [1:6] 78 81 82 83 84 85
#&gt;   ..$ : num [1:11] 75 86 87 88 89 90 91 92 93 94 ...
#&gt;   ..$ : int [1:2] 95 96
#&gt;   ..$ : num [1:3] 95 97 98
#&gt;   ..$ : int [1:2] 98 99
#&gt;   ..$ : int [1:2] 99 100
#&gt;   ..$ : num [1:3] 99 101 102
#&gt;   ..$ : num [1:7] 98 103 104 105 106 107 108
#&gt;   ..$ : int [1:2] 108 109
#&gt;   ..$ : int [1:4] 109 110 111 112
#&gt;   ..$ : num [1:4] 109 113 114 115
#&gt;   ..$ : int [1:3] 115 116 117
#&gt;   ..$ : num [1:3] 115 118 119
#&gt;   ..$ : int [1:3] 119 120 121
#&gt;   ..$ : num [1:14] 119 122 123 124 125 126 127 128 129 130 ...
#&gt;   ..$ : num [1:2] 108 135
#&gt;   ..$ : int [1:9] 135 136 137 138 139 140 141 142 143
#&gt;   ..$ : int [1:6] 143 144 145 146 147 148
#&gt;   ..$ : num [1:7] 143 149 150 151 152 153 154
#&gt;   ..$ : num [1:7] 135 155 156 157 158 159 160
#&gt;   ..$ : int [1:6] 160 161 162 163 164 165
#&gt;   ..$ : num [1:5] 160 166 167 168 169
#&gt;   ..$ : int [1:4] 169 170 171 172
#&gt;   ..$ : num [1:9] 169 173 174 175 176 177 178 179 180
#&gt;  $ d            :'data.frame':	180 obs. of  7 variables:
#&gt;   ..$ PointNo: int [1:180] 1 2 3 4 5 6 7 8 9 10 ...
#&gt;   ..$ Label  : num [1:180] 2 2 2 2 2 2 2 2 2 2 ...
#&gt;   ..$ X      : num [1:180] 187 187 188 188 188 ...
#&gt;   ..$ Y      : num [1:180] 133 131 130 129 129 ...
#&gt;   ..$ Z      : num [1:180] 88.2 90.6 93.1 95 97.5 ...
#&gt;   ..$ W      : num [1:180] 1.01 1.27 1.14 1.27 1.27 1.27 1.27 1.27 1.27 1.27 ...
#&gt;   ..$ Parent : num [1:180] -1 1 2 3 4 5 6 7 8 9 ...
#&gt;  $ OrientInfo   :List of 5
#&gt;   ..$ AxonOriented: logi TRUE
#&gt;   ..$ AVMPoint    : logi NA
#&gt;   ..$ AVLPoint    : logi NA
#&gt;   ..$ Scl         : num [1:3] 1 1 1
#&gt;   ..$ NewAxes     : num [1:3] 1 2 3
#&gt;  $ SegOrders    : num [1:33] 1 2 2 3 4 4 3 4 5 5 ...
#&gt;  $ MBPoints     : int [1:2] 34 48
#&gt;  $ LHBranchPoint: int 75
#&gt;  $ SegTypes     : num [1:33] 1 3 1 3 3 3 1 2 2 2 ...
#&gt;  $ AxonSegNos   :List of 3
#&gt;   ..$ PreMBAxons : int 1
#&gt;   ..$ MBAxons    : int 3
#&gt;   ..$ PostMBAxons: int 7
#&gt;  $ LHSegNos     : num [1:26] 8 9 10 11 12 13 14 15 16 17 ...
#&gt;  $ MBSegNos     :List of 2
#&gt;   ..$ : int 2
#&gt;   ..$ : num [1:3] 4 5 6
#&gt;  $ NumMBBranches: num 2
#&gt;  $ AxonLHEP     : num 72
#&gt;  - attr(*, "class")= chr [1:2] "neuron" "list"</div><div class='input'><span class='co'># summary of 3D points</span>
<span class='fu'><a href='summary.neuronlist.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='xyzmatrix.html'>xyzmatrix</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        X               Y                Z        
#&gt;  Min.   :186.9   Min.   : 90.36   Min.   : 88.2  
#&gt;  1st Qu.:225.6   1st Qu.: 97.56   1st Qu.:103.4  
#&gt;  Median :258.4   Median :102.70   Median :112.9  
#&gt;  Mean   :249.4   Mean   :104.03   Mean   :120.9  
#&gt;  3rd Qu.:277.7   3rd Qu.:109.04   3rd Qu.:139.0  
#&gt;  Max.   :289.5   Max.   :132.71   Max.   :157.3  </div><div class='input'><span class='co'># identify 3d location of endpoints</span>
<span class='fu'><a href='xyzmatrix.html'>xyzmatrix</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='rootpoints.html'>endpoints</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>,<span class='op'>]</span>
</div><div class='output co'>#&gt;            X         Y         Z
#&gt; 1   186.8660 132.70932  88.20393
#&gt; 42  224.7067 109.86362 153.58749
#&gt; 59  229.6343  92.30637 157.29700
#&gt; 62  226.8855  90.36325 147.59602
#&gt; 80  249.8864  93.59079 136.77795
#&gt; 85  253.0099  90.94904 137.34921
#&gt; 96  264.0801  98.53390 121.89463
#&gt; 100 266.3223  98.73241 116.46558
#&gt; 102 267.5460  98.59859 112.85608
#&gt; 112 271.0762 102.67288 100.84955
#&gt; 117 274.6128 100.92061 103.28772
#&gt; 121 277.3920 102.19148 102.69473
#&gt; 134 287.1214 101.43365 103.30740
#&gt; 148 281.7958  96.63987 101.08075
#&gt; 154 276.6551  95.09809  99.22113
#&gt; 165 278.3287 113.75627 104.87700
#&gt; 172 282.3069 111.93213 105.65492
#&gt; 180 289.5364 111.96014 109.18281</div><div class='input'>
<span class='co'>## Other methods</span>
<span class='co'># plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># all methods for neuron objects</span>
<span class='fu'><a href='https://rdrr.io/r/utils/methods.html'>methods</a></span><span class='op'>(</span>class <span class='op'>=</span> <span class='st'>'neuron'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] -                  *                  /                  +                 
#&gt;  [5] all.equal          as.neuron          as.ngraph          as.seglist        
#&gt;  [9] boundingbox        branchpoints       dotprops           endpoints         
#&gt; [13] ndigest            nvertices          plot               plot3d            
#&gt; [17] potential_synapses prune              resample           rootpoints        
#&gt; [21] scale              subset             summary            write.vtk         
#&gt; [25] xform              xyzmatrix          xyzmatrix&lt;-       
#&gt; see '?methods' for accessing help and source code</div><div class='input'>
<span class='co'>## Neurons as graphs </span>
<span class='co'># convert to graph and find longest paths by number of nodes</span>
<span class='va'>ng</span><span class='op'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/distances.html'>distances</a></span><span class='op'>(</span><span class='va'>ng</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># ... or in distances  microns</span>
<span class='va'>ngw</span><span class='op'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span><span class='op'>(</span><span class='va'>n</span>, weights<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/distances.html'>distances</a></span><span class='op'>(</span><span class='va'>ngw</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># converting back and forth between neurons and graphs</span>
<span class='va'>g</span><span class='op'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>gstem</span><span class='op'>=</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/subgraph.html'>induced.subgraph</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
<span class='co'># this is fine</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>gstem</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>gstem</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># but if you had an undirected graph </span>
<span class='va'>ug</span><span class='op'>=</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/as.directed.html'>as.undirected</a></span><span class='op'>(</span><span class='va'>gstem</span><span class='op'>)</span>
<span class='co'># you get a warning because there is no explicit origin for the graph</span>
<span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>ug</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: No valid origin found! Using first endpoint as origin</span></div><div class='output co'>#&gt; $NumPoints
#&gt; [1] 10
#&gt; 
#&gt; $StartPoint
#&gt; [1] 1
#&gt; 
#&gt; $BranchPoints
#&gt; integer(0)
#&gt; 
#&gt; $EndPoints
#&gt; [1]  1 10
#&gt; 
#&gt; $nTrees
#&gt; [1] 1
#&gt; 
#&gt; $NumSegs
#&gt; [1] 1
#&gt; 
#&gt; $SegList
#&gt; [[1]]
#&gt;  [1]  1  2  3  4  5  6  7  8  9 10
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "seglist" "list"   
#&gt; 
#&gt; $d
#&gt;    PointNo Label        X        Y         Z    W Parent
#&gt; 1        1     2 186.8660 132.7093  88.20393 1.01     -1
#&gt; 2        2     2 187.3355 131.1558  90.59680 1.27      1
#&gt; 3        3     2 188.1165 130.2545  93.14326 1.14      2
#&gt; 4        4     2 188.4680 129.4757  94.97399 1.27      3
#&gt; 5        5     2 188.2875 128.7542  97.45621 1.27      4
#&gt; 6        6     2 188.2733 127.9567  99.16801 1.27      5
#&gt; 7        7     2 188.4558 127.5704 101.53992 1.27      6
#&gt; 8        8     2 188.9997 127.5399 103.69540 1.27      7
#&gt; 9        9     2 189.6382 126.6176 104.95399 1.27      8
#&gt; 10      10     2 189.4185 126.1251 108.07660 1.27      9
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "neuron" "list"  </div><div class='input'>
<span class='co'># If you need finer control of the conversion process </span>
<span class='va'>gstem2</span><span class='op'>=</span><span class='fu'><a href='ngraph.html'>as.ngraph</a></span><span class='op'>(</span><span class='va'>ug</span>, root <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>gstem2</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>as.neuron</span><span class='op'>(</span><span class='va'>gstem2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='neuron-7.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory Jefferis, James Manton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


