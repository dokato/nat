<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>3D plots of the elements in a neuronlist, optionally using a subset 
expression — plot3d.neuronlist • nat</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="3D plots of the elements in a neuronlist, optionally using a subset 
expression — plot3d.neuronlist" />
<meta property="og:description" content="plot3d.character is a convenience method intended for 
  exploratory work on the command line." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.8.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Installation.html">Installation Details</a>
    </li>
    <li>
      <a href="../articles/neurons-intro.html">Introduction to neurons and neuronlists</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/natverse/nat/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>3D plots of the elements in a neuronlist, optionally using a subset 
expression</h1>
    <small class="dont-index">Source: <a href='https://github.com/natverse/nat/blob/master/R/neuronlist.R'><code>R/neuronlist.R</code></a></small>
    <div class="hidden name"><code>plot3d.neuronlist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>plot3d.character</code> is a convenience method intended for 
  exploratory work on the command line.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for neuronlist</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  subset <span class='op'>=</span> <span class='cn'>NULL</span>,
  col <span class='op'>=</span> <span class='cn'>NULL</span>,
  colpal <span class='op'>=</span> <span class='va'>rainbow</span>,
  skipRedraw <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fl'>200L</span>, <span class='cn'>TRUE</span><span class='op'>)</span>,
  WithNodes <span class='op'>=</span> <span class='cn'>FALSE</span>,
  soma <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>,
  SUBSTITUTE <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='co'># S3 method for character</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>x</span>, db <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a neuron list or, for <code>plot3d.character</code>, a character vector of
neuron names. The default neuronlist used by plot3d.character can be set by
using <code><a href='https://rdrr.io/r/base/options.html'>options(nat.default.neuronlist='mylist')</a></code>. See 
?<code><a href='nat-package.html'>nat</a></code> for details. <code><a href='nat-package.html'>nat-package</a></code>.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>Expression evaluating to logical mask for neurons. See details.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>An expression specifying a colour evaluated in the context of the 
dataframe attached to nl (after any subsetting). See details.</p></td>
    </tr>
    <tr>
      <th>colpal</th>
      <td><p>A vector of colours or a function that generates colours</p></td>
    </tr>
    <tr>
      <th>skipRedraw</th>
      <td><p>When plotting more than this many (default 200) neurons 
skip redraw for individual neurons (this is much faster for large number of
neurons). Can also accept logical values TRUE (always skip) FALSE (never 
skip).</p></td>
    </tr>
    <tr>
      <th>WithNodes</th>
      <td><p>Whether to plot points for end/branch points. Default: 
<code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>soma</th>
      <td><p>Whether to plot a sphere at neuron's origin representing the 
soma. Either a logical value or a numeric indicating the radius (default 
<code>FALSE</code>). When <code>soma=TRUE</code> the radius is hard coded to 2.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>options passed on to plot3d (such as colours, line width etc)</p></td>
    </tr>
    <tr>
      <th>SUBSTITUTE</th>
      <td><p>Whether to <code>substitute</code> the expressions passed as 
arguments <code>subset</code> and <code>col</code>. Default: <code>TRUE</code>. For expert 
use only, when calling from another function.</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>A neuronlist to use as the source of objects to plot. If
<code>NULL</code>, the default, will use the neuronlist specified by
options('nat.default.neuronlist')</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list of values of <code>plot3d</code> with subsetted dataframe as attribute
  <code>'df'</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The col and subset parameters are evaluated in the context of the 
  dataframe attribute of the neuronlist. If col evaluates to a factor and 
  colpal is a named vector then colours will be assigned by matching factor 
  levels against the named elements of colpal. If there is one unnamed level,
  this will be used as catch-all default value (see examples).</p>  
<p>If col evaluates to a factor and colpal is a function then it will be used 
  to generate colours with the same number of levels as are used in col.</p>  
<p>WithNodes is <code>FALSE</code> by default when using <code>plot3d.neuronlist</code> 
  but remains <code>TRUE</code> by default when plotting single neurons with 
  <code><a href='plot3d.neuron.html'>plot3d.neuron</a></code>. This is because the nodes quickly make plots 
  with multiple neurons rather busy.</p>  
<p>When <code>soma</code> is <code>TRUE</code> or a vector of numeric values (recycled as 
  appropriate), the values are used to plot cell bodies. For neurons the 
  values are passed to <code>plot3d.neuron</code> for neurons. In contrast 
  <code>dotprops</code> objects still need special handling. There must be columns 
  called <code>X,Y,Z</code> in the data.frame attached to <code>x</code>, that are then 
  used directly by code in <code>plot3d.neuronlist</code>.</p>  
<p>Whenever plot3d.neuronlist is called, it will add an entry to an 
  environment <code>.plotted3d</code> in <code>nat</code> that stores the ids of all the 
  plotted shapes (neurons, cell bodies) so that they can then be removed by a
  call to <code>npop3d</code>.</p>
<p>plot3d.character will check if options('nat.default.neuronlist') has
  been set and then use x as an identifier to find a neuron in that 
  neuronlist.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='nat-package.html'>nat-package</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>open3d</span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; glX 
#&gt;   8 </div><div class='input'><span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>kcs20</span>,<span class='va'>type</span><span class='op'>==</span><span class='st'>'gamma'</span>,col<span class='op'>=</span><span class='st'>'green'</span><span class='op'>)</span>
<span class='co'># \donttest{</span>
<span class='fu'>clear3d</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>kcs20</span>,col<span class='op'>=</span><span class='va'>type</span><span class='op'>)</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span>,<span class='va'>Glomerulus</span><span class='op'>==</span><span class='st'>"DA1"</span>,col<span class='op'>=</span><span class='st'>'red'</span><span class='op'>)</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span>,<span class='va'>Glomerulus</span><span class='op'>==</span><span class='st'>"VA1d"</span>,col<span class='op'>=</span><span class='st'>'green'</span><span class='op'>)</span>
<span class='co'># Note use of default colour for non DA1 neurons</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span>,col<span class='op'>=</span><span class='va'>Glomerulus</span>, colpal<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>DA1<span class='op'>=</span><span class='st'>'red'</span>, <span class='st'>'grey'</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># a subset expression</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span>,<span class='va'>Glomerulus</span><span class='op'>%in%</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DA1"</span>,<span class='st'>'VA1d'</span><span class='op'>)</span>,
  col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>,<span class='st'>"green"</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Glomerulus</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='co'># the same but not specifying colours explicitly</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>Cell07PNs</span>,<span class='va'>Glomerulus</span><span class='op'>%in%</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DA1"</span>,<span class='st'>'VA1d'</span><span class='op'>)</span>,col<span class='op'>=</span><span class='va'>Glomerulus</span><span class='op'>)</span>
<span class='co'># }</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## more complex colouring strategies for a larger neuron set</span>
<span class='co'># see https://github.com/jefferis/frulhns for details</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>frulhns</span><span class='op'>)</span>
<span class='co'># notice the sexually dimorphic projection patterns for these neurons</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>jkn</span>,<span class='va'>cluster</span><span class='op'>==</span><span class='st'>'aSP-f'</span> <span class='op'>&amp;</span><span class='va'>shortGenotype</span><span class='op'>==</span><span class='st'>'JK1029'</span>, 
  col<span class='op'>=</span><span class='va'>sex</span>,colpal<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>male<span class='op'>=</span><span class='st'>'green'</span>,female<span class='op'>=</span><span class='st'>'magenta'</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## colour neurons of a class by input resistance</span>
<span class='va'>jkn.aspg</span><span class='op'>=</span><span class='fu'><a href='subset.html'>subset</a></span><span class='op'>(</span><span class='va'>jkn</span>, <span class='va'>cluster</span><span class='op'>==</span><span class='st'>'aSP-g'</span><span class='op'>)</span>
<span class='co'># NB this comes in as a factor</span>
<span class='va'>Ri</span><span class='op'>=</span><span class='fu'><a href='neuronlist-dataframe-methods.html'>with</a></span><span class='op'>(</span><span class='va'>jkn.aspg</span>,<span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Ri..GOhm.</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># the matlab jet palette</span>
<span class='va'>jet.colors</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'navy'</span>,<span class='st'>'cyan'</span>,<span class='st'>'yellow'</span>,<span class='st'>'red'</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='plot3d.html'>plot3d</a></span><span class='op'>(</span><span class='va'>jkn.aspg</span>,col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>Ri</span>,<span class='fl'>20</span><span class='op'>)</span>,colpal<span class='op'>=</span><span class='va'>jet.colors</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory Jefferis, James Manton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


